<div class="relative inline-block text-left">
  <!-- Dropdown Toggle Button -->
  <button type="button"
          id="adminMenu-{{ loop.index }}"
          class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 focus:outline-none"
          onclick="toggleDropdown('dropdown-{{ loop.index }}')"
          aria-haspopup="true"
          aria-expanded="false">
    <i class="fas fa-ellipsis-v"></i>
  </button>

  <!-- Dropdown Menu (initially hidden) -->
  <div id="dropdown-{{ loop.index }}"
       class="origin-top-left absolute left-full top-0 mt-0 ml-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 hidden z-10"
       aria-labelledby="adminMenu-{{ loop.index }}">
    <div class="py-1">
      <!-- Refresh Token Form -->
      <form method="POST" action="{{ url_for('user.generate_new_token', agent_id=agent.agentid) }}">
        {{ generateTokenForm.hidden_tag() }}
        <button id="refreshToken-{{ loop.index }}"
                name="generateToken"
                type="submit"
                title="Refresh Token"
                onclick="return confirm('Are you sure you want to generate a new token for {{ agent.agentid }}? This will invalidate any existing agents using this token.')"
                class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
          <i class="fas fa-sync-alt text-blue-500 mr-1"></i>Refresh Token
        </button>
      </form>
      <!-- Change Name Button -->
      <button id="agentName-{{ loop.index }}"
              name="changename"
              type="button"
              title="Change Agent Name"
              data-toggle="modal"
              data-target="#agentmodal"
              data-agentid="{{ agent.agentid }}"
              data-agentname="{{ agent.friendly_name }}"
              data-action="changename"
              class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
        <i class="fas fa-pencil-alt text-blue-500 mr-1"></i>Change Name
      </button>
    </div>
  </div>
</div>
